{"version":3,"sources":["uiVsResult.js"],"names":["uiPanel","require","mvs","cc","Class","extends","properties","loseClip","default","url","AudioClip","victoryClip","onLoad","_super","player","nodeDict","getComponent","node","active","rival","on","quit","engine","leaveRoom","gamePanel","uiFunc","findUI","closeUI","destroy","name","Game","GameManager","lobbyShow","setData","data","i","friendIds","length","ins","instantiate","parent","script","enemyIds","isWin","selfScore","rivalScore","audioEngine","play","Label","string","loginServer"],"mappings":"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","file":"uiVsResult.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\common\\script","sourcesContent":["var uiPanel = require(\"uiPanel\");\r\nvar mvs = require(\"Matchvs\");\r\ncc.Class({\r\n    extends: uiPanel,\r\n\r\n    properties: {\r\n        loseClip: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        victoryClip: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        }\r\n    },\r\n\r\n    onLoad() {\r\n        this._super();\r\n        this.player = this.nodeDict[\"player\"].getComponent(\"resultPlayerIcon\");\r\n        this.player.node.active = false;\r\n        this.rival = this.nodeDict[\"rival\"].getComponent(\"resultPlayerIcon\");\r\n        this.rival.node.active = false;\r\n        this.nodeDict[\"quit\"].on(\"click\", this.quit, this);\r\n    },\r\n\r\n    quit: function() {\r\n        mvs.engine.leaveRoom(\"\");\r\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\r\n        if (gamePanel) {\r\n            uiFunc.closeUI(\"uiGamePanel\");\r\n            gamePanel.destroy();\r\n        }\r\n        uiFunc.closeUI(this.node.name);\r\n        this.node.destroy();\r\n\r\n        Game.GameManager.lobbyShow();\r\n    },\r\n\r\n    setData(data) {\r\n        for (var i = 0; i < data.friendIds.length; i++) {\r\n            var ins = cc.instantiate(this.player.node);\r\n            ins.active = true;\r\n            ins.parent = this.player.node.parent;\r\n            var script = ins.getComponent(\"resultPlayerIcon\");\r\n            script.setData(data.friendIds[i]);\r\n        }\r\n\r\n        for (var i = 0; i < data.enemyIds.length; i++) {\r\n            var ins = cc.instantiate(this.rival.node);\r\n            ins.active = true;\r\n            ins.parent = this.rival.node.parent;\r\n            var script = ins.getComponent(\"resultPlayerIcon\");\r\n            script.setData(data.enemyIds[i]);\r\n        }\r\n\r\n        var isWin = data.selfScore >= data.rivalScore;\r\n        this.nodeDict[\"lose\"].active = !isWin;\r\n        this.nodeDict[\"win\"].active = isWin;\r\n        if (isWin) {\r\n            cc.audioEngine.play(this.victoryClip, false, 1);\r\n        } else {\r\n            cc.audioEngine.play(this.loseClip, false, 1);\r\n        }\r\n\r\n        if (data.selfScore || data.rivalScore) {\r\n            this.nodeDict[\"vs\"].active = false;\r\n            this.nodeDict[\"score\"].active = true;\r\n\r\n            this.nodeDict[\"playerScore\"].getComponent(cc.Label).string = data.selfScore;\r\n            this.nodeDict[\"rivalScore\"].getComponent(cc.Label).string = data.rivalScore;\r\n        } else {\r\n            this.nodeDict[\"vs\"].active = true;\r\n            this.nodeDict[\"score\"].active = false;\r\n        }\r\n\r\n        if (isWin) {\r\n            // 发送胜局记录--\r\n            Game.GameManager.loginServer();\r\n        }\r\n    }\r\n});\r\n"]}